---
layout: post
title: 评价算法之————聚类分析（Cluster Analysis）
date: 2023-12-18
Author: nanxa 
tags: [algorithm, mcm_icm]
comments: true
toc: true
---


聚类分析是一种**无监督机器学习方法**，用于分类较大数据集中的数据。聚类分析将分类对象按照数据之间的相似程度分成若干类，而这些**类别没有事先给定**。

## 1. 基本原理
根据数据的指标，通过指标计算不同数据之间的距离确定各数据之间的相似度，将距离相近的数据合为一类。

## 2. 步骤
假设数据如下：
![微信图片_20231218190008.jpg](https://s2.loli.net/2023/12/18/h4S7BFpfVw981un.jpg)

### 2.1 数据变换
由于不同数据指标具有不同的属性（量纲），要消除量纲的影响，就要先进行数据变换。数据变换有如下三种方法：
#### 2.1.1 中心化处理
中心化变换是一种**坐标轴平移**处理方法，先求出每个变量的样本平均值，再从原始数据中减去该变量的均值，得到中心化变换后的数据。
![微信图片_20231218190010.jpg](https://s2.loli.net/2023/12/18/EWkX7Bw4GFVyvmf.jpg)

#### 2.1.2 规格化变换
规格化变换是从数据矩阵中的每一个变量中找到其最大值和最小值，这两者之差称为极差，然后从每个变量的原始数据中减去该变量中的最小值，再除以极差，就得到规格化数据。
![微信图片_202312181900101.jpg](https://s2.loli.net/2023/12/18/OoZvGh1Qmx7rbin.jpg)

#### 2.1.3 标准化变换*
首先对每个变量进行中心化变换，然后**除以该变量的标准差**进行标准化，即有
![微信图片_20231218190011.jpg](https://s2.loli.net/2023/12/18/PTvAiZ9MQY7tkFI.jpg)

假设变换后的样本数据矩阵为：
![微信图片_20231218190012.jpg](https://s2.loli.net/2023/12/18/xnOCjYWp3t2u41B.jpg)

### 2.2 样本（或指标）间亲疏程度的测度计算
研究样本或指标的亲疏程度的数量指标通常有两种：一种是**相似系数**，另一种是**距离**。对样本进行分类常用距离来测度样品之间的亲疏程度，而对指标之间的聚类常用相似系数来测度指标间的亲疏程度。

#### 2.2.1 相似系数
**性质越接近的变量或者样品，相似系数的取值越接近于1或-1，而彼此无关的变量或样品的相似系数则越接近于0**，相似的归为一类，不相似的归为不同类。

##### (1) 夹角余弦
将两个样品数据看做两个向量，即可**通过夹角的余弦值**来计算两样本的相似系数
![微信图片_20231218190013.jpg](https://s2.loli.net/2023/12/18/gSamMeI6lTxzEo7.jpg)
![微信图片_202312181900131.jpg](https://s2.loli.net/2023/12/18/zWxMpB3cGAtRjwV.jpg)

##### (2) 皮尔逊相关系数*
皮尔逊相关系数的几何意义可以类比夹角余弦
![微信图片_20231218190014.jpg](https://s2.loli.net/2023/12/18/dCWlVaugORKHAmf.jpg)

#### 2.2.2 距离
**将每个样品看作p维空间的一个点，n个样品组成p维空间的n个点。用各点之间的距离来衡量各样品之间的相似程度**。距离近的点归为一类，距离远的点属于不同的类。

##### (1) 闵式（Minkowski）距离
![微信图片_20231218190015.jpg](https://s2.loli.net/2023/12/18/Nxzvcgf2wVPX8It.jpg)

##### (2) 马氏（Mahalanobis）距离 (矩阵的协方差计算)
![微信图片_20231218184336.jpg](https://s2.loli.net/2023/12/18/jfbAmPxC95Qzgu4.jpg)

### 2.3 聚类（题目举例在 “3.实例” 中）
#### 2.3.1 系统聚类法
***步骤***：
1. 将每个样品（或变量）独自聚成一类，构造n个类
2. 根据所确定的距离公式，计算n个样品（或变量）两两之间的距离，构造距离矩阵，记为$D_{0}$
3. 把距离最近的两类归为一新类，其他样品（或变量）仍各自聚为一类，此时共有n-1类
4. 迭代上述操作，直到最后将所有样品（或变量）聚为一类。
5. 画聚类谱系图，决定类的个数及各类包含的样品数，并对类做出解释

***类与类之间距离的定义***：
1. **最短距离法**：定义类之间的距离为两类间最邻近的两样品的距离
![微信图片_20231218190017.jpg](https://s2.loli.net/2023/12/18/iyCmAwcVjI4zPFM.jpg)

2. **最长距离法**：定义类之间的距离为两类最远样品之间的距离
![微信图片_20231218190018.jpg](https://s2.loli.net/2023/12/18/zSsNbK5I7Cgj6OW.jpg)

3. 其他定义方法：重心法、类平均法、离差平方和法
![微信图片_20231218190019.jpg](https://s2.loli.net/2023/12/18/dNsIOVm7Ppj9UMt.jpg)
![微信图片_20231218190022.jpg](https://s2.loli.net/2023/12/18/LCdXehSoITPa2WD.jpg)

#### 2.3.2 动态聚类法
用于解决大型数据的聚类，减少计算机的运算量
##### K均值聚类
思想：*先假设数据集中的全体样本可分为C类，选定C个**初始聚类中心**，根据最小距离原则将每个样本分配到某一类中，之后不断迭代计算各类的聚类中心，依据新的聚类中心调整聚类情况，直到迭代收敛或聚类中心不再改变*。
**步骤**：
![微信图片_20231218190023.jpg](https://s2.loli.net/2023/12/18/wCAbh7dqQVcyInR.jpg)

***最佳簇数k值的确定***：
1. **簇内离差平方和拐点法**：重点关注斜率的变化，当斜率突然由大变小并且之后的斜率变化缓慢时，认为突然变化的点就是寻找的目标点。
![微信图片_20231218190024.jpg](https://s2.loli.net/2023/12/18/QdLC85AHETK4Ulm.jpg)

2. **轮廓系数法**：综合考虑簇的密集性和分散性：**如果数据集分隔理想，则对应的簇内样本会很密集，而簇间样本会很分散**
![微信图片_20231218190025.jpg](https://s2.loli.net/2023/12/18/M7eFHGc2qh5XBQo.jpg)

#### 2.3.3 R型（对指标）聚类法
变量相似性度量参考前文提到的相关系数度量方法
聚类方法使用前文提到的最长距离法或者最短距离法，需要注意的是**此时对距离的定义**：
![微信图片_20231218190026.jpg](https://s2.loli.net/2023/12/18/yVSoapR2K3DUmwH.jpg)

## 3. 实例
### 3.1 系统聚类中最短距离法的实例
![微信图片_20231218190027.jpg](https://s2.loli.net/2023/12/18/CoBvALOXjSbwk3e.jpg)
![微信图片_20231218190028.jpg](https://s2.loli.net/2023/12/18/i3Imo92xD7ArhJl.jpg)

### 3.2 k均值聚类的实例
![微信图片_20231218190029.jpg](https://s2.loli.net/2023/12/18/KhvMXHCzjG9pJbq.jpg)

### 3.3 R型聚类法的实例
![微信图片_20231218190030.jpg](https://s2.loli.net/2023/12/18/LlqUS1k92wcrzRh.jpg)
![微信图片_20231218190032.jpg](https://s2.loli.net/2023/12/18/iAv7GKVOzuoHZw5.jpg)

## 4. 应用场景
**分析类问题中未给出指定分类标准和类别的分类问题，或者不同分类指标的相关性问题**。



>参考文献：
>[1] 司守奎，孙玺菁. Python数学建模算法与应用[M]. 北京：国防工业出版社，2022